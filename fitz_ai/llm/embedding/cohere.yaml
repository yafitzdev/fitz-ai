# fitz_ai/llm/embedding/cohere.yaml
#
# Cohere Embedding Plugin - v2 Embed API
# Documentation: https://docs.cohere.com/reference/embed
#
# IMPORTANT: Cohere v2 API returns embeddings in a different format:
#   { "embeddings": { "float": [[...], [...]] } }
# The path must be "embeddings.float[0]" for single text or "embeddings.float" for batch.

# =============================================================================
# IDENTITY
# =============================================================================
plugin_name: "cohere"
plugin_type: "embedding"
version: "2.0"

# =============================================================================
# PROVIDER
# =============================================================================
provider:
  name: "cohere"
  base_url: "https://api.cohere.ai/v2"

# =============================================================================
# AUTHENTICATION
# =============================================================================
auth:
  type: "bearer"
  header_name: "Authorization"
  header_format: "Bearer {key}"
  env_vars:
    - "COHERE_API_KEY"

# =============================================================================
# REQUIRED ENVIRONMENT VARIABLES (optional section)
# =============================================================================
required_env: []

# =============================================================================
# HEALTH CHECK (optional section)
# =============================================================================
health_check: null

# =============================================================================
# ENDPOINT
# =============================================================================
endpoint:
  path: "/embed"
  method: "POST"
  timeout: 30

# =============================================================================
# DEFAULTS
# =============================================================================
defaults:
  model: "embed-multilingual-v3.0"
  input_type: "search_document"

# =============================================================================
# REQUEST CONFIGURATION
# =============================================================================
request:
  input_field: "texts"
  input_wrap: "list"
  static_fields: {}
  param_map:
    model: "model"
    input_type: "input_type"
    dimensions: "output_dimension"

# =============================================================================
# RESPONSE CONFIGURATION
# =============================================================================
# Cohere v2 API response format:
#   {
#     "embeddings": {
#       "float": [[0.1, 0.2, ...], [0.3, 0.4, ...]]
#     }
#   }
# For single text: embeddings.float[0]
# For batch: embeddings.float
response:
  embeddings_path: "embeddings.float[0]"
  is_array: true
  array_index: 0