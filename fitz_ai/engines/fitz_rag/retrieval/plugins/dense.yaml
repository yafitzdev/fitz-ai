# fitz_ai/engines/fitz_rag/retrieval/plugins/dense.yaml
#
# Dense Retrieval Plugin (No Reranking)
#
# Pure vector search without cross-encoder reranking.
# Use this when you don't have a reranker configured or want faster queries.
# For better precision, use dense_rerank instead.
#
# VectorSearchStep has built-in:
# - Multi-query expansion for long queries (automatic, no config needed)
# - Keyword filtering for exact term matching (automatic, no config needed)
# - Deduplication of results (automatic, no config needed)

plugin_name: dense
description: "Dense retrieval with vector search only (no reranking)"

# Pipeline steps - executed in order
# Each step references a Python class in fitz_ai.engines.fitz_rag.retrieval.steps
steps:
  - type: artifact_fetch       # Fetch artifacts first (always included)
    enabled_if: fetch_artifacts

  - type: vector_search        # Intelligent vector search (multi-query + keyword baked in)
    k: 25                      # Candidates to retrieve (larger pool to not miss relevant chunks)
    use_config: top_k          # Use top_k from config if set (multiplied by 2)

  - type: limit
    k: 10                      # Final chunks returned (uses retrieval.top_k from config)
    use_config: top_k          # Override k with value from retrieval config
