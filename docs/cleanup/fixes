● ---
  COMPLETE SUMMARY

  PART 1: QUALITY IMPROVEMENTS (Commit c601085)

  File: fitz_ai/engines/fitz_rag/retrieval/steps/vector_search.py

  1. Document Type Boosting - Match query intent to chunk content type
    - Detects if query wants structured data (salary, count, table) vs narrative (who is, describe, explain)
    - Boosts chunks that match intent, penalizes mismatches
    - Params: narrative_boost=1.5, structured_boost=1.4, default_boost=1.25
  2. Source Diversification - Max N chunks from any single source
    - Prevents one document from dominating results
    - Param: max_per_source=3
  3. Query Intent Patterns - Regex patterns for detection:
    - _STRUCTURED_QUERY_PATTERNS: salary, employee data, how many, average/sum/count, etc.
    - _NARRATIVE_QUERY_PATTERNS: who is, describe, company, CEO, history, meeting, etc.

  File: fitz_ai/retrieval/aggregation/detector.py

  4. Higher k_multiplier for aggregations - Changed from 3-4 to 5
    - More comprehensive results for COUNT, LIST, UNIQUE queries

  File: fitz_ai/retrieval/vocabulary/detector.py

  5. Company name detection patterns - Added:
    - CamelCase: GreenDrive, TechCorp, AutoMotors
    - With suffix: TechCorp Industries, GreenDrive Inc

  ---
  PART 2: E2E REWORK SPECS (Commits ced27f4 → b00ae03)

  Persistent Vector DB Collection

  - Collection name: e2e_test (fixed, no UUID suffix)
  - Force mode: force=False (reuse existing data)
  - Teardown: No-op (keeps collection for reuse)

  Conditional Docling Loading

  - Check file hashes via IngestStateManager BEFORE importing heavy modules
  - Only import Docling if files needing ingestion are PDFs/DOCXs
  - ParserRouter(docling_parser=None) skips docling entirely

  Enrichment Module Restructure (ced27f4)

  - Moved modules from enrichment/chunk/ to enrichment/modules/chunk/
  - Moved hierarchy from enrichment/hierarchy/ to enrichment/modules/hierarchy/
  - Added prompts to enrichment/prompts/chunk/ and enrichment/prompts/hierarchy/
  - New registry at enrichment/registry.py